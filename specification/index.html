<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Programming Assignment 3: Web APIs and design mockups</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <meta charset="UTF-8" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>

    <script>
      hljs.highlightAll();
    </script>

    <script>
      // TODO
      const createHeader = () => {
        const headerBg = document.getElementById("header-bg");
        headerBg.innerHTML = "";

        // https://materialui.co/colors
        const colors = [
          "#FFEBEE",
          "#FCE4EC",
          "#F3E5F5",
          "#EDE7F6",
          "#E8EAF6",
          "#E3F2FD",
          "#E1F5FE",
          "#E0F7FA",
          "#E0F2F1",
          "#E8F5E9",
          "#F1F8E9",
          "#F9FBE7",
          "#FFFDE7",
          "#FFF8E1",
          "#FFF3E0",
          "#FBE9E7",
          "#EFEBE9",
          "#FAFAFA",
          "#ECEFF1",
        ];

        for (let i = 0; i < 6; i++) {
          const pillContainer = document.createElement("div");
          pillContainer.classList.add("pill-container");
          headerBg.appendChild(pillContainer);

          const totalWidth = headerBg.offsetWidth;

          const initialOffset = -Math.random() * 100;
          pillContainer.style.transform = `translateX(${initialOffset}px) `;
          let pillsWidth = initialOffset;
          let iters = 0;
          while (pillsWidth < totalWidth + 300 && iters < 100) {
            const pill = document.createElement("div");
            pill.classList.add("pill");
            pill.style.width = `calc(${Math.random() + 0.5} * 160pt / 6)`;
            pill.style.transform = `translateY(${Math.random() * 0.3 * 100}%)`;
            pill.style.backgroundColor =
              colors[Math.floor(Math.random() * colors.length)];
            pillContainer.appendChild(pill);

            pillsWidth += pill.offsetWidth;

            iters++;
          }
        }
      };

      const debounce = (func, wait, immediate) => {
        let timeout;
        return function () {
          const context = this,
            args = arguments;
          const later = function () {
            timeout = null;
            if (!immediate) func.apply(context, args);
          };
          const callNow = immediate && !timeout;
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
          if (callNow) func.apply(context, args);
        };
      };

      const createHeaderDebounced = debounce(createHeader, 500);

      window.addEventListener("DOMContentLoaded", createHeader);
      window.addEventListener("resize", createHeaderDebounced);
    </script>
  </head>

  <body>
    <header>
      <div id="header-bg" class="header-bg" aria-hidden></div>
      <h1>
        <span class="pre-header">CS 160/260A Programming Assignment 3</span
        ><br />Web APIs and design mockups
      </h1>
    </header>
    <main>
      <p>Welcome to CS 160’s third programming assignment!</p>

      <p>In this four-part programming assignment, you will:</p>

      <ul>
        <li>Practice designing navigation flows</li>
        <li>Write a script with Playwright, an end-to-end testing framework</li>
        <li>Fetch data from a remote API</li>
        <li>
          Use multimedia APIs for speech recognition, text-to-speech, and webcam
          access
        </li>
      </ul>

      <p>Let’s dive in!</p>

      <h2>Contents</h2>

      <ul>
        <li>
          <a href="#Collaboration">Collaboration policy</a>
        </li>
        <li>
          <a href="#Starter_code">Starter code</a>
        </li>
        <li>
          <a href="#Submission">Submission</a>
        </li>
        <li>
          <a href="#Autograder">Autograder</a>
        </li>

        <li>
          <a href="#Part_1">Part 1 · Design Mockup and Navigation Prototype</a>
        </li>
        <li>
          <a href="#Part_2">Part 2 · The outside world</a>
        </li>
        <li>
          <a href="#Part_3">Part 3 · Voice assistant</a>
        </li>
        <li>
          <a href="#Part_4">Part 4 · Profile pic persistence</a>
        </li>
      </ul>

      <h2 id="Collaboration">Collaboration policy</h2>

      <p>
        Programming assignments should be your own. You are not allowed to copy
        other students code, or copy/modify large chunks of code or entire
        projects found online (e.g. on GitHub).
      </p>

      <p>
        You are allowed to consult online resources, e.g. Stack Overflow, to get
        answers to specific implementation questions.
      </p>

      <p>
        LLM-based tools like ChatGPT and GitHub Copilot are helpful and
        increasingly common in industry, and
        <strong>you may use them</strong> to help you complete assignments, with
        the following caveats:
      </p>

      <ul>
        <li>
          You should stick to using AI for line- or function-level edits; do
          <strong>not</strong> paste the entire chunks of the assignment
          description into ChatGPT (it’s pretty obvious when you do this).
          Programming assignments are not quite like real-world software
          development, because we often provide detail in the specification that
          would not normally be written out for you in a real-world project. If
          you use these tools, you should practice the skill of communicating
          with the tools rather than letting the assignment document do this for
          you.
        </li>
        <li>
          We generally describe what we want you to learn from a particular
          exercise. Work through each task with the intention of
          <strong>practicing the skills we mention</strong>; if AI helped you
          get unstuck, do your best to come away with an understanding of the
          concepts targeted by the assignment.
        </li>
        <li>
          When we ask you to think about the design and aesthetics of your
          application,
          <strong>we’re looking for <em>your</em> creative spark</strong>. AI
          can be great for helping you find the right CSS rules to style an
          element, but you should be making your own high-level decisions.
        </li>
        <li>
          The goal of these assignments is to develop your skills to work
          independently on code implementations. LLMs can be part of this
          process, but when you prompt AI tools to help you write assignment
          code,
          <strong>you should not share the exact prompts you used</strong> with
          other students. This has a similar effect as sharing code, since it
          prevents other students from developing their own skills with the
          tools they are using. Of course, it's always okay to exchange
          high-level advice with your peers.
        </li>
      </ul>

      <h2 id="Starter_code">Starter code</h2>

      <p>
        This assignment includes starter code in the
        <code>code</code> directory. You should build on top of this code for
        your assignment submission.
      </p>

      <p>
        Please do <strong>not</strong> fork the repository on GitHub or upload
        your code anywhere public-facing. Remember, students aren’t allowed to
        directly copy each other’s code for these assignments; if another
        student copies your code, we won’t be able to tell who copied whom, and
        you’ll be on the hook for the plagiarism too!
      </p>

      <h2 id="Submission">Submission</h2>

      <p>
        You will modify the starter code provided to you with the assignment,
        then submit your code as a zip file to Gradescope containing your code
        submission. Gradescope will give you a score for the autogradable
        portions of the assignment, but some portions will be manually graded by
        course staff after the submission deadline.
      </p>

      <p>Submission file structure:</p>

      <ul>
        <li>submission.zip</li>
        <ul>
          <li>part1/</li>
          <ul>
            <li>index.html</li>
            <li>add-task.html</li>
            <li>tasks.html</li>
            <li>main.css</li>
            <li><strong>part1.spec.js</strong></li>
            <li>(any other supporting files...)</li>
          </ul>
          <li>part2/</li>
          <ul>
            <li>index.html</li>
            <li>(any other supporting files...)</li>
          </ul>
          <li>part3/</li>
          <ul>
            <li>index.html</li>
          </ul>
          <li>part4/</li>
          <ul>
            <li>images/</li>
            <ul>
              <li>profile.svg</li>
            </ul>
            <li>index.html</li>
          </ul>
          <li>index.html</li>
          <li>serve.json</li>
          <li>(any other support files you create)</li>
        </ul>
      </ul>

      <h2 id="Autograder">Autograder</h2>

      <p>
        <strong
          >For this homework, you will need to run the local autograder!</strong
        >
      </p>

      <p>
        If you want to use
        <a href="https://playwright.dev/docs/running-tests"
          >Playwright’s interactive debugging UI</a
        >, you can run the autograder locally by cloning the
        <a
          href="https://github.com/cs160-spring2025/programming-assignment-2-autograder"
          >autograder repository</a
        >
        and following the instructions in the README.
      </p>

      <p>
        If you’re having trouble with the installation, please make an Ed post.
      </p>

      <section id="Part_1" style="margin-top: 48px">
        <h2>Part 1 · Design Mockup and Navigation Prototype</h2>
        <p>
          <em>Skills: Navigation, visual design, Playwright</em>
        </p>

        <div class="admonition-info">
          <p>Hi! Hello!</p>
          <p>
            Task 1 is great fun. But before you start, I recommend
            <strong> skipping ahead to task 2 </strong> and creating an API key
            for the OpenWeather API. These keys can sometimes take a while to
            start working, so it’s best to get that out of the way now in
            advance of actually starting task 2.
          </p>
        </div>

        <h3>Background</h3>
        <p>
          In this task you will be given a low-fidelity sketch of an interface
          prototype, and you will use Web technologies (HTML, CSS, and
          JavaScript) to create a higher-fidelity prototype of the sketch.
        </p>

        <p>
          In prior assignments, you designed the aesthetics of the interface,
          but we did not have you design the actual <em>interactions</em>; you
          were required to abide by our autograder’s specification for which
          elements were clickable and how they would behave.
        </p>

        <p>
          In this assignment, that will change. <strong>You</strong> will write
          the “autograder” for this assignment, building not just an interface,
          but also a test script that “clicks” through the interface and
          interacts with various elements. You can think of this like you’re
          recording a video to demo your UI to course staff, except instead of
          recording your screen, you’ll be writing code that executes a sequence
          of interactions.
        </p>

        <h3>Task</h3>

        <p>
          You will need to create 3 HTML files with some set of elements (see
          below) and implement the ability to navigate between them.
          Additionally, we want you to practice your design skills by styling
          the interface in a consistent and coherent way.
        </p>
        <p>
          <strong
            >You do not need to implement the logical functionality of this
            interface (e.g. adding tasks to the task planner) to earn full
            credit;</strong
          >
          your goal here will be to create well-designed pages that have basic
          navigation to other pages in the application. This is similar to the
          kind of low-fidelity prototyping your team will do in Figma, except in
          this assignment, you will implement this basic functionality using Web
          technologies.
        </p>
        <div class="image-container">
          <img
            src="images/lofi.jpg"
            alt="Sketch of task planner app. Your app design can look very different than this!"
          />
        </div>
        <span class="caption" style="text-align: center; display: block">
          Sketch of task planner app. Your app design can look very different
          than this!
        </span>
        <p>
          You will need to prototype a simple task planning app. Each page of
          your prototype will consist of its own HTML page. Clicking relevant
          parts of the interface will navigate the browser to the next/previous
          view in the interface, based on what the user clicked. See the “Tasks”
          section below for more detail.
        </p>
        <p>
          <strong
            >You are free to design these pages however you like; the sketches
            above are provided for reference only.</strong
          >
          Please get creative! Practice your visual design skills, reference the
          design principles that we’ve learned in class and apply them to the
          best of your ability.
        </p>
        <p>
          You should design for a <strong>mobile</strong> screen size. In
          particular,
          <a href="https://playwright.dev/docs/emulation#devices"
            >we will configure Playwright</a
          >
          (our testing framework) to load the page as though it is on as
          <strong>Pixel 7 phone (screen size 412 x 915)</strong>. During
          development, you can ask your desktop web browser to simulate a mobile
          phone screen (often referred to as Responsive Design Mode, see the
          docs for
          <a href="https://developer.chrome.com/docs/devtools/device-mode"
            >Chrome</a
          >,
          <a
            href="https://firefox-source-docs.mozilla.org/devtools-user/responsive_design_mode/"
            >Firefox</a
          >,
          <a
            href="https://developer.apple.com/documentation/safari-developer-tools/responsive-design-mode"
            >Safari</a
          >).
        </p>
        <p>
          You should use interactive HTML form components (e.g.
          <code>&lt;input type="text"&gt;</code>, <code>&lt;textarea&gt;</code>,
          <code>&lt;input type="textbox"&gt;</code>) in your design and may
          style them however you wish.
        </p>
        <p>
          Since you won’t be implementing the logical functionality of the
          prototype:
        </p>
        <ul>
          <li>
            All data (the project names and task lists) can be static, meaning
            the information is hard-coded into the HTML page and does not change
            as the user interacts with the app.
          </li>
          <li>
            You only need to implement one “Project” page (the middle sketch in
            the figure above); clicking on any project in the left pane can lead
            to the same project page.
          </li>
        </ul>

        <h3>Playwright</h3>
        <p>
          <a href="https://playwright.dev/docs/writing-tests">Playwright</a> is
          the end-to-end testing framework we have been using to automatically
          grade portions of your assignments thus far. For this task, there will
          be no automatically-graded portion.
        </p>
        <p>
          Instead, we’d like <strong>you</strong> to author a Playwright test
          that automates the web browser and demonstrates the user’s journey
          through using your prototype. Starter code has been provided in the
          file <code>tests/part1.spec.js</code> of the
          <a
            href="https://github.com/cs160-summer2024/cs-160-su24-programming-assignment-3-autograder"
            >autograder repo</a
          >. Your Playwright test will produce a trace that shows all of the
          pages of the user interface. You may choose to write one long test, or
          to split the specification into multiple tests, but please keep all
          the tests in the one spec file.
        </p>
        <p>
          Playwright tests are written in JavaScript, though this Playwright
          JavaScript never runs inside your webpage; instead, the JavaScript
          code inside the <code>spec</code> (“specification”) file is used by
          Playwright to instruct the browser where to go, what to look for, and
          what to click on. A typical Playwright test contains interleaved
          instructions and assertions. For example, on an e-commerce website:
        </p>
        <ol>
          <li>Go to the page "/cart/checkout"</li>
          <li>
            Check that the "#total" element contains the sum of the values in
            the "#subtotal" and "#tax" elements
          </li>
        </ol>
        <div class="admonition-info">
          <p>
            In a typical real-world application, the idea is to add this kind of
            end-to-end test into your codebase and run the tests before
            deploying any changes to your application. If another engineer comes
            along in the future and breaks your tax calculation code, the
            assertion (step 2) of the test would fail, halting the deploy (you
            can learn more about setting up tests for your software projects in
            CS 169!).
          </p>
        </div>
        <p>
          For this part of the assignment, you won’t need to author any
          <em>assertions</em> (checks like step 2 shown above). Instead, you’ll
          write JavaScript code to program Playwright to click on the various
          elements of your interface, recording a trace that your course staff
          will be able to view in Gradescope as a sort of “video recording” of
          your interface (as you have seen in the autograded components of past
          assignments).
        </p>
        <p>
          You will almost certainly want to
          <a href="#autograder">download and run the autograder locally</a> for
          this assignment, since you will actually need to modify the autograder
          itself (by modifying the <code>part1.spec.js</code> file in the
          autograder’s <code>/tests/</code> directory) to run and observe your
          Playwright trace.
        </p>

        <p>
          In your submission, you’ll simply
          <strong>
            copy the
            <code>part1.spec.js</code> file you create into the
            <code>/part1</code> directory of your submission</strong
          >, and the Gradescope autograder will place it in the right spot
          before running your code. Playwright’s
          <a href="https://playwright.dev/docs/test-ui-mode"
            >interactive UI mode</a
          >
          is very handy for authoring tests!
        </p>

        <div class="admonition-info">
          <p>
            The above paragraph is important! Make sure you place the test file
            in the correct spot so the autograder can find it.
          </p>
        </div>

        <p>
          We highly recommend setting up and running the autograder on the
          starter code to observe the trace for the provided skeleton code. This
          will help you understand the script that we want you to write.
        </p>
        <p>Here is an example Playwright test:</p>
        <pre><code class="language-javascript">
import { expect, test } from "@playwright/test";

test(
  "Navigate to all pages", // Test Name
  async ({ page }) => {    // Test Code
    await page.goto("/part1/index.html");
    expect(await page.title()).toBe("Programming assignment");
  }
);
        </code></pre>
        <p>
          This test checks to make sure the title of the page is “Programming
          assignment”.
        </p>
        <p>
          When navigating in your UI, you will most likely be simulating clicks
          on elements.
        </p>
        <pre><code class="language-javascript">
await page.locator("#cool-element").click();
        </code></pre>
        <p>
          This will find an element with id cool-element and click it. You can
          put any selector in this call! Since Playwright runs an actual web
          browser in the background, clicking on things will do whatever it
          would do in the browser (e.g. trigger a JavaScript action, submit a
          form, or navigate to another page, if that’s what the click target
          does).
        </p>
        <p>
          There are
          <a href="https://playwright.dev/docs/input">a lot of actions</a> you
          can take with Playwright. Here are a few more, for example.
        </p>
        <pre><code class="language-javascript">
await page.locator("#bananas").check(); // Check a checkbox with id "bananas"
await page.locator("#name-text").fill('Oski'); // Find a text box with id "name-text" and fill it with the word "Oski"
await page.locator("#cars").selectOption("volvo"); // Find a drop down list with id "cars" and select the item called "volvo"
await page.getByText("Coolest Dogs").click(); // Find an element with the text "Coolest Dogs" (which probably leads to a page about poodles)
        </code></pre>
        <p>
          You might need to look through the Playwright docs to find the right
          interactions for your design!
        </p>
        <p>
          Write a full Playwright script that navigates to all of the pages in
          your UI. Make sure you demonstrate implemented UI features (such as
          typing in forms) as well as back buttons.
        </p>

        <div class="admonition-warning">
          <p>
            Although you can use <code>page.goto()</code> to navigate to the
            <em>initial</em> page, all other navigations should be performed
            using interactions within the UI. Think of
            <code>page.goto()</code> as the equivalent of the user manually
            typing a URL into the browser’s address bar; it’s probably not the
            interaction you want to require of your users for navigation!
          </p>
        </div>

        <h3>Checklist</h3>
        <p>Create the following HTML views and navigation between them:</p>
        <ul>
          <li>
            Projects View
            <ul>
              <li>
                A list of various projects. Clicking on any project will go to
                the Task View
              </li>
              <li>
                An add button to add new projects (this does not need to
                navigate anywhere)
              </li>
            </ul>
          </li>
          <li>
            Task View
            <ul>
              <li>
                A list of tasks, each of which contains a name, a description,
                due date, and a completion status
              </li>
              <li>Add button that navigates to the Add Task View</li>
              <li>Back button that returns to the Projects View</li>
            </ul>
          </li>
          <li>
            Add Task View
            <ul>
              <li>Form fields for task name, description, due date</li>
              <li>OK/Save button that navigates back to the Task View</li>
              <li>Cancel button that navigates back to the Task View</li>
            </ul>
          </li>
        </ul>
        <p>
          Create a Playwright trace that navigates to all of the above views
        </p>
        <ul>
          <li>
            Demonstrate at least 4 page transitions
            <ul>
              <li>Projects -> Tasks</li>
              <li>Tasks -> Add Task</li>
              <li>Add Task -> Tasks</li>
              <li>Tasks -> Projects</li>
            </ul>
          </li>
          <li>Demonstration of form filling for Add Task page</li>
          <li>
            You may need to add appropriate IDs in your application code to make
            it easier to find elements in Playwright. It is also common to use
            <a href="https://playwright.dev/docs/locators#locate-by-test-id"
              >Test IDs</a
            >
            for this purpose.
          </li>
        </ul>

        <h3>Scoring (12 points)</h3>
        <ul>
          <li>
            8 points: Implementation
            <ul>
              <li>
                5 points: All three screens are implemented, with the required
                elements, navigation, and form fields.
              </li>
              <li>
                3 points: Provided Playwright trace correctly navigates to all
                pages in the prototype and uses various form fields. We will
                verify this manually.
              </li>
            </ul>
          </li>
          <li>
            4 points: Visual design and interactions
            <ul>
              <li>2 points: general visual design</li>
              <li>
                2 points: sensible interactions (button clicks, form fields,
                etc.)
              </li>
            </ul>
          </li>
        </ul>

        <h3>Resources</h3>
        <ul>
          <li>
            <a href="https://playwright.dev/docs/writing-tests"
              >Playwright - Writing tests</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent"
              >MouseEvent - Web APIs | MDN</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Location/assign"
              >Location: assign() method - Web APIs | MDN</a
            >
          </li>
        </ul>
      </section>
      <section id="Part_2">
        <h2>Part 2 · The outside world</h2>
        <p>
          <em
            >Skills: Remote API requests, Web platform APIs, creating
            elements</em
          >
        </p>

        <h3>Background</h3>
        <p>
          For this task, you will use a weather API to fetch the real-life
          hourly forecast. Weather APIs typically need a latitude and longitude
          location for where to report the weather. We’ve provided the location
          for Jacob’s Hall as a default, but you can change this if you’d like!
        </p>
        <p>
          Use the
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch"
            >fetch() API</a
          >
          with the
          <a href="https://openweathermap.org/forecast5">OpenWeather</a> weather
          API to query for the weather at the location. Display the information
          in some useful/pretty layout.
        </p>
        <p>
          When you request data from an API, it is returned as a Response that
          contains JSON data. You will need to extract the JSON data and display
          it by modifying or adding DOM elements. Read the API documentation
          carefully - in particular the section that describes
          <a href="https://openweathermap.org/forecast5#geo5"
            >how to make an API call</a
          >, and how to
          <a href="https://openweathermap.org/forecast5#fields_JSON"
            >process the returned data</a
          >.
        </p>
        <p>
          You must use the forecast API endpoint linked above! OpenWeather
          offers many endpoints, but our autograder will check if the
          <code>forecast</code>
          endpoint is used.
        </p>
        <p style="margin-left: 1.5rem">
          <code>https://api.openweathermap.org/data/2.5/forecast</code>
        </p>
        <p>
          Here is an example of how to use fetch and access the returned data.
          The url is available in the previously linked docs. Make sure you set
          url to the correct URL <strong>with your apiKey</strong>!
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals"
            >Template literals</a
          >
          may be useful, but there are many ways to construct the url. You can
          try the URL in your web browser’s address bar to verify that it is
          returning data before using it in your code.
        </p>
        <pre><code class="language-javascript">
fetch(url)
  .then((data) => {
    return data.json();
  })
  .then((json) => {
    console.log(json["city"]["name"]); // Prints "Berkeley"
  });
  </code></pre>

        <h3>Task</h3>
        <p>Display the following information in your interface:</p>
        <ol>
          <li>
            <strong>Current time</strong> (either your browser’s current time or
            the location’s current time) and the location’s
            <strong>coordinates</strong> and <strong>city name</strong>.
          </li>
          <li>
            Hourly forecast for the next 24 hours (if impossible, first 24 hours
            of accessible data) in 3-hour blocks. For each 3-hour step, display
            the <strong>time</strong>, the <strong>weather</strong> (e.g.,
            cloudy, partly cloudy, sunny), the <strong>temperature</strong>, and
            the <strong>wind speed</strong>.
          </li>
        </ol>

        <h3>Extra Credit (2 points)</h3>
        <p>
          The
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API/Using_the_Geolocation_API"
            >Web Geolocation API</a
          >
          will let you get the user’s current location in the world. The user’s
          browser will first ask for permission, then call your registered
          JavaScript callback with the user’s current (approximate) latitude and
          longitude.
        </p>
        <p>
          You should handle the error case (when the user’s location is not
          available, e.g. because the user did not give permission) and use
          these coordinates by default:
          <code>[34.98722, 135.74250]</code> (the
          <a href="https://www.kyotorailwaymuseum.jp/en/"
            >Kyoto Railway Museum</a
          >).
          <!-- better NOT to use a Berkeley location here, since it’s harder for a student to tell the fallback is working -->
        </p>
        <p>
          Note that the Geolocation API is typically only available when serving
          your website over HTTPS, but your browser will make an exception for
          <code>localhost</code>. This exception won’t apply if you’re accessing
          your local server from a mobile device.
        </p>

        <h3>Scoring (4+2 points)</h3>
        <ul>
          <li>
            2 Points - autograded
            <ul>
              <li>
                Validates that you call the API correctly and use the results in
                the page
              </li>
            </ul>
          </li>
          <li>2 Points - Visual design</li>
          <li>2 Points (additional task) - Using the geolocation API</li>
        </ul>
        <p>
          It is possible to score 6/4 points on this task, but the assignment
          grade will be capped at 20/20 points. Implementing the extra
          functionality can help compensate for deductions due to design
          feedback!
        </p>

        <h3>Resources</h3>

        <div class="admonition-warning">
          🚨Here’s where you’ll create the API key! Start this early, because it
          takes time!! 🚨
        </div>

        <ul>
          <li>
            <a href="https://openweathermap.org/forecast5"
              >OpenWeather API: 5 day weather forecast - OpenWeatherMap</a
            >,
            <a href="https://openweathermap.org/appid"
              >https://openweathermap.org/appid</a
            >
            <p>
              Note: You will need to create a free account (no need to provide
              any billing information). API keys may take a few hours to
              activate – if you get a 401 response from the API, try waiting a
              while. The linked API (/forecast) is the right one to use with the
              free API key.
            </p>
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API/Using_the_Geolocation_API"
              >Using the Geolocation API</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch"
              >Using the Fetch API</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals"
              >Template Literals in JS</a
            >
          </li>
        </ul>
      </section>
      <section id="Part_3">
        <h2>Part 3 · Voice assistant</h2>
        <p><em>Skills: Web platform APIs, DOM manipulation</em></p>
        <div class="admonition-info">
          If you have registered disability accommodations related to speech or
          hearing, you may also choose to complete this task using the
          <code>window.prompt()</code> and <code>window.alert()</code> APIs for
          input and output.
        </div>
        <p>
          The
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API/Using_the_Web_Speech_API"
            >Web Speech API</a
          >
          lets you add voice control to your Web applications. Not every browser
          supports the full API (notably, Firefox is missing speech recognition
          support), but you can complete this task in at least Chrome, Safari,
          Edge, and Opera.
        </p>
        <p>
          You’ll build a simple voice assistant that listens to the user’s
          speech command and toggles a light in their house (represented by
          toggling a class on a div element).
        </p>
        <p>
          When the user clicks “Listen for voice command”, the page should wait
          for them to speak a command using the SpeechRecognition API. If the
          user says the word “bathroom”, “bedroom”, “kitchen”, or “living room”
          anywhere in their command, you should toggle the .lit class for the
          appropriate div. If more than one of these rooms is mentioned, you can
          choose to toggle one or all of them.
        </p>
        <p>
          When the user’s command is finished,
          <strong>speak back to the user</strong> using the SpeechSynthesis API:
        </p>
        <ul>
          <li>If no light was toggled, say “Sorry, I didn’t understand”.</li>
          <li>
            If a light was toggled, say “I’ve just toggled the light in {room}”.
          </li>
        </ul>
        <p>
          You will likely need to use a
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API/Using_the_Web_Speech_API#prefixed_properties"
            >browser prefix</a
          >
          to get this API to work. You won’t need a grammar for this task, so
          you can ignore documentation about those features. You’ll probably
          want the following options when you construct your speech recognizer:
        </p>
        <ul>
          <li>continuous: false</li>
          <li>lang: "en-US"</li>
          <li>interimResults: false</li>
          <li>maxAlternatives: 1</li>
        </ul>
        <p>You will need to make sure a user can:</p>
        <ul>
          <li>Toggle the kitchen light with voice controls.</li>
          <li>Toggle the bathroom light with voice controls.</li>
          <li>
            Say a nonsensical voice command (like “water my plants”) and show
            the application rejecting this request.
          </li>
        </ul>
        <p>
          Consider how you might use these APIs in your final team prototype to
          enable voice input and output features!
        </p>
        <h3>Scoring (2 points)</h3>
        <p>
          This task will be graded automatically by following the series of
          steps listed above. There is no manually-graded component for this
          task.
        </p>
        <h3>Resources</h3>
        <ul>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API/Using_the_Web_Speech_API"
              >Using the Web Speech API</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition"
              >SpeechRecognition - Web APIs | MDN</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesis"
              >SpeechSynthesis - Web APIs | MDN</a
            >
          </li>
        </ul>
      </section>

      <section id="Part_4">
        <h2>Part 4 · Profile pic persistence</h2>
        <p>
          <em
            >Skills: input elements, localStorage, Data URIs, getUserMedia API,
            modals, Promises</em
          >
        </p>
        <div class="image-container">
          <img
            src="images/pfp-container.png"
            alt="The starter code includes a default profile card, but nothing happens when you try to change it!"
          />
        </div>
        <span class="caption" style="text-align: center; display: block"
          >The starter code includes a default profile card, but nothing happens
          when you try to change it!</span
        >
        <p>
          In this task, you’ll implement a “profile” card with a “name” and
          “photo” input. The card data will persist in the user’s browser so
          that it is not lost when the page is refreshed.
        </p>
        <p>
          First, use the
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"
            >localStorage API</a
          >
          to <strong>save the user’s name</strong> inside the browser whenever
          they make a change to the input field. The most convenient event
          listener for the input will be the
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Element/input_event"
            >‘oninput’ event</a
          >
          (you can use ‘onchange’ too, but it will only fire when the user
          clicks away from the input field).
        </p>
        <p>
          Update the window ‘onload’ listener to find the saved name in
          localStorage. If the user has changed their name in the past,
          <strong>update the name input field</strong> so that it contains the
          user’s previously-typed name. Of course, if the user has never visited
          your page before, nothing will be saved, and you don’t need to change
          the input from its default value.
        </p>
        <p>
          Once you’ve gotten the name working, do the same for the profile
          picture.
        </p>
        <p>
          In the starter code, the modal that pops up when the image is clicked
          includes an empty <code>&lt;video&gt;</code> element that can be used
          to <strong>read the user’s webcam state</strong>; you should complete
          and/or test this assignment on a device that has a webcam (if you
          don’t have a webcam, you may be able to simulate one with a Virtual
          Webcam software like
          <a href="https://obsproject.com/kb/virtual-camera-guide">OBS</a>).
        </p>
        <div class="image-container">
          <img
            src="images/pfp-tweet.png"
            alt="A tweet: 'What kind of spontaneous nutcase clicks on 'take a new profile picture' and just bangs one out there and then'. Credit: Dave"
          />
        </div>
        <span class="caption" style="text-align: center; display: block"
          >Credit: Dave
        </span>
        <p>
          When the page loads, you should use the
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia"
            >navigator.mediaDevices.getUserMedia API</a
          >
          to <strong>update that <code>&lt;video&gt;</code> tag</strong> so that
          it shows the content of the user’s webcam (this will require that the
          user accept the “webcam” permission upon loading the page). You’ll
          need to use the <code>stream</code> object provided asynchronously by
          the mediaDevices API, then set a relevant attribute on the video
          element, retrieved using the DOM APIs.
        </p>
        <p>When the user clicks on the “Capture” button, you’ll want to:</p>
        <ul>
          <li>
            Make a new JavaScript “canvas” element with the DOM API.
            <code>&lt;canvas&gt;</code> tags can be used to write pixels exactly
            to a drawing buffer, rather than drawing using UI toolkits provided
            by the DOM.
            <ul>
              <li>
                <code>const canvas = document.createElement('canvas');</code>
              </li>
            </ul>
          </li>
          <li>
            Set its width and height equal to the video element’s
            <code>videoWidth</code> and <code>videoHeight</code> attributes:
            <ul>
              <li>
                <code>canvas.width = ...; // and the same for height</code>
              </li>
            </ul>
          </li>
          <li>
            Get the canvas’s <strong>drawing context</strong>;
            <ul>
              <li><code>const ctx = canvas.getContext('2d');</code></li>
            </ul>
          </li>
          <li>
            And draw the contents of the <em>video</em> element onto the canvas:
            <ul>
              <li>
                <code
                  >ctx.drawImage(video, 0, 0, canvas.width,
                  canvas.height);</code
                >
              </li>
            </ul>
          </li>
        </ul>
        <p>
          Then, you’ll be able to grab the current contents of that Canvas
          element as a <strong>data URL</strong>:
        </p>
        <ul>
          <li><code>const dataUrl = canvas.toDataURL('image/jpeg');</code></li>
        </ul>
        <div
          style="
            background-color: #eeedfb;
            border-color: rgb(149, 95, 224);
            color: rgb(42, 18, 77);
            padding: 1rem;
            margin: 1rem 0;
            border: 1px solid;
            border-radius: 0.25rem;
          "
        >
          A data URL, which starts with <code>data:</code> instead of a request
          protocol like <code>http:</code>, can be used in many places where
          other URLs work (like in links, <code>&lt;img&gt;</code> src
          attributes, CSS background images, <code>&lt;audio&gt;</code> tags,
          etc.). The difference from typical URLs is that, instead of linking to
          some asset that the browser will retrieve using an HTTP request, data
          URLs <em>contain</em> the entire asset inside the URL, encoding the
          binary byte data with
          <a href="https://developer.mozilla.org/en-US/docs/Glossary/Base64"
            >base-64 encoding</a
          >. A data URL looks something like this:

          <p style="margin-left: 1.5rem">
            <code
              ><span style="color: #01579b">data:</span
              ><span style="color: #f57f17">image/png;</span
              ><span style="color: #880e4f">base64,</span
              >iVBORw0KGgoAAAANSUhEUgAAAAEAA...</code
            >
          </p>

          First is the <code style="color: #01579b">data:</code> prefix
          specifying that this is a data URL. Then, a
          <a href="https://developer.mozilla.org/en-US/docs/Glossary/MIME_type"
            >MIME type</a
          >
          (<code style="color: #f57f17">image/png</code>) that tells the browser
          what kind of file this is (like a file extension does). The text
          <code style="color: #880e4f">base64</code> chooses the encoding type,
          followed by the actual encoded data.
        </div>
        <p>
          We can use that data URL to update the <code>&lt;img&gt;</code> tag’s
          src attribute.
        </p>
        <p>
          First, though, let’s <strong>resize the image</strong>. localStorage
          only allows us to store 5 megabytes on the user’s computer per
          website, so we need to be thrifty. We’ve provided an image resizing
          function in the starter code, which will take in a data URL, draw the
          image to a fresh <code>&lt;canvas&gt;</code> element, then read the
          image data back out of the canvas, returning a new data URL with the
          resized image.
        </p>
        <p>
          Or – that’s <em>almost</em> what it returns. In fact, resizing the
          image is an asynchronous process, so it won’t complete immediately.
          The resize function we gave you will return a
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises"
            >Promise</a
          >, so you’ll need to <strong>add a callback</strong> to listen for
          when it’s finished (or use
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"
            >async/await</a
          >!). This is the same technique you’ll have used to make use of the
          media stream returned by getUserMedia.
        </p>
        <p>
          When the resize operation is done,
          <strong>save the image to localStorage</strong> (you’ll want to use a
          different key than you used in the first part) and
          <strong>close the Bootstrap modal</strong>. Then,
          <strong>update the profile pic element</strong> to use the new image.
        </p>
        <p>
          Then, <strong>update your window.onload function</strong> so that the
          user’s saved profile picture is loaded automatically when the page
          loads (if they’ve uploaded one already).
        </p>
        <p>You will need to make sure a user can:</p>
        <ul>
          <li>Change the user’s name in the profile card.</li>
          <li>
            Refresh the page. The name should automatically load to match what
            was already typed.
          </li>
          <li>
            Open the profile pic selector and snap a picture from the webcam.
          </li>
          <li>The modal should close itself after clicking “Capture”.</li>
          <li>The profile picture in the card should be updated.</li>
          <li>
            Refresh the page. The card should now contain both the updated name
            and the new profile picture.
          </li>
        </ul>
        <h3>Scoring (2 points)</h3>
        <p>
          This task will be graded automatically by following the series of
          steps listed above. There is no manually-graded component for this
          task.
        </p>

        <h3>Resources</h3>
        <ul>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"
              >Window: localStorage property - Web APIs | MDN</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Element/input_event"
              >Element: input event - Web APIs | MDN</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia"
              >MediaDevices: getUserMedia() method - Web APIs | MDN</a
            >
          </li>
          <li>
            <a
              href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Introducing"
              >Introducing asynchronous JavaScript - Learn web development |
              MDN</a
            >
            <ul>
              <li>
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises"
                  >Using promises - JavaScript | MDN</a
                >
              </li>
              <li>
                <a
                  href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"
                  >async function - JavaScript | MDN</a
                >
              </li>
            </ul>
          </li>
        </ul>
      </section>
    </main>
  </body>
</html>
